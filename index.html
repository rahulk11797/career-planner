<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mastery OS | 90-Day Engineering Elite</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root[data-theme="dark"] {
            --bg: #0d1117; --sidebar-bg: #161b22; --card-bg: #1c2128;
            --border: #30363d; --accent: #58a6ff; --text-main: #c9d1d9; --text-bold: #f0f6fc;
            --java: #ffa657; --dsa: #ff7b72; --system-design: #d2a8ff; --database: #79c0ff; 
            --devops: #7ee787; --observability: #a5d6a7; --security: #f2cc60; --interview: #ffffff;
        }
        :root[data-theme="light"] {
            --bg: #f6f8fa; --sidebar-bg: #ffffff; --card-bg: #ffffff;
            --border: #d0d7de; --accent: #0969da; --text-main: #24292f; --text-bold: #1f2328;
            --java: #d47e2c; --dsa: #cf222e; --system-design: #8250df; --database: #0550ae;
            --devops: #1a7f37; --observability: #116329; --security: #9a6700; --interview: #1f2328;
        }

        body { 
            background-color: var(--bg); color: var(--text-main); 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; 
            font-size: 0.85rem; margin: 0; padding-top: 65px; transition: 0.3s;
        }

        /* Responsive Header */
        .glass-header {
            position: fixed; top: 0; width: 100%; z-index: 1100;
            background: var(--sidebar-bg); border-bottom: 1px solid var(--border);
            padding: 10px 15px; display: flex; justify-content: space-between; align-items: center;
        }

        /* Sidebar Styling */
        .sidebar { background: var(--sidebar-bg); border-right: 1px solid var(--border); padding: 25px 20px; }
        
        @media (min-width: 992px) { 
            .sidebar { position: sticky; top: 65px; height: calc(100vh - 65px); overflow-y: auto; }
            .mobile-toggle { display: none; }
        }

        /* Mobile specific adjustments */
        @media (max-width: 991px) {
            .sidebar { border-right: none; border-bottom: 1px solid var(--border); }
            .offcanvas { background-color: var(--sidebar-bg) !important; color: var(--text-main); border-right: 1px solid var(--border); }
        }

        .live-clock { font-size: 2.2rem; font-weight: 800; color: var(--accent); text-align: center; font-variant-numeric: tabular-nums; }
        .date-display { color: var(--text-main); font-weight: 700; text-align: center; font-size: 0.7rem; margin-bottom: 20px; opacity: 0.7; text-transform: uppercase; }

        .motivation-box { padding: 15px; background: rgba(88, 166, 255, 0.08); border-left: 4px solid var(--accent); border-radius: 4px; margin-bottom: 25px; }

        .portal-link {
            display: flex; align-items: center; gap: 10px; padding: 10px; 
            margin-bottom: 8px; border-radius: 6px; background: rgba(255,255,255,0.03); 
            color: var(--text-main); text-decoration: none; font-weight: 600; border: 1px solid var(--border); transition: 0.2s;
        }
        .portal-link:hover { background: var(--border); color: var(--accent); }

        /* Card Responsive Layout */
        .day-card { background: var(--card-bg); border: 1px solid var(--border); border-radius: 10px; margin-bottom: 24px; overflow: hidden; }
        .day-label { background: rgba(0,0,0,0.04); padding: 10px 15px; font-weight: 800; color: var(--accent); border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center;}
        
        .task-slot { 
            display: flex; align-items: center; padding: 12px 15px; 
            border-bottom: 1px solid var(--border); gap: 12px; flex-wrap: wrap; 
        }
        .task-slot:last-child { border-bottom: none; }
        
        .task-info { flex: 1; min-width: 200px; display: flex; align-items: center; gap: 10px; }
        .task-meta { display: flex; align-items: center; gap: 15px; margin-left: auto; }

        .tag { font-size: 0.6rem; padding: 2px 8px; border-radius: 4px; font-weight: 900; text-transform: uppercase; white-space: nowrap; border: 1px solid rgba(255,255,255,0.1); }
        
        .btn-study { font-size: 0.65rem; font-weight: 700; color: var(--accent); text-decoration: none; border: 1px solid var(--accent); padding: 4px 10px; border-radius: 5px; background: transparent; transition: 0.2s; white-space: nowrap; }
        .btn-study:hover { background: var(--accent); color: #fff; }

        .p-bar { height: 6px; background: var(--border); border-radius: 3px; overflow: hidden; margin-top: 5px; }
        .p-fill { height: 100%; transition: width 0.5s; background: var(--accent); }

        @media print { .no-print { display: none !important; } body { padding-top: 0; } }
        
        /* Hamburger menu styling */
        .navbar-toggler { border-color: var(--border); padding: 4px 8px; }
        .navbar-toggler-icon { filter: invert(50%); }
    </style>
</head>
<body>

<header class="glass-header no-print">
    <div class="d-flex align-items-center gap-2">
        <button class="navbar-toggler mobile-toggle" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebarOffcanvas">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="fw-bold">MASTERY OS <span style="color:var(--accent)">v4.2</span></div>
    </div>
    <div class="d-flex gap-2">
        <button class="btn btn-sm btn-outline-info" onclick="toggleTheme()">üåì</button>
        <button class="btn btn-sm btn-primary" onclick="window.print()">EXPORT</button>
    </div>
</header>

<div class="container-fluid">
    <div class="row">
        <aside class="col-lg-3 sidebar d-none d-lg-block no-print">
            <div id="sidebar-content">
                </div>
        </aside>

        <div class="offcanvas offcanvas-start d-lg-none no-print" tabindex="-1" id="sidebarOffcanvas">
            <div class="offcanvas-header border-bottom border-secondary">
                <h5 class="offcanvas-title fw-bold">DASHBOARD</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"></button>
            </div>
            <div class="offcanvas-body p-0" id="mobile-sidebar-content">
                </div>
        </div>

        <main class="col-lg-9 p-3 p-md-4">
            <div id="roadmap-grid"></div>
        </main>
    </div>
</div>

<script src="data.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    const QUOTES = window.MASTER_QUOTES;
    const DATA = window.MASTER_DATA;

    function toggleTheme() {
        const root = document.documentElement;
        const target = root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
        root.setAttribute('data-theme', target);
        localStorage.setItem('theme', target);
    }

    function updateClock() {
        const now = new Date();
        const timeStr = now.toLocaleTimeString('en-GB');
        const dateStr = now.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
        
        document.querySelectorAll('.live-clock').forEach(el => el.innerText = timeStr);
        document.querySelectorAll('.date-display').forEach(el => el.innerText = dateStr);
    }

    function injectSidebar() {
        const content = `
            <div class="p-4 p-lg-0">
                <div class="live-clock">00:00:00</div>
                <div class="date-display">...</div>

                <div class="motivation-box">
                    <div style="font-size: 0.6rem; font-weight: 900; color: var(--accent); margin-bottom: 5px;">DAILY_MINDSET</div>
                    <div id="quote-text" class="quote-container" style="font-style: italic; font-size: 0.8rem; line-height: 1.4;">"Code is craft."</div>
                </div>

                <div class="stat-group mb-4">
                    <div class="d-flex justify-content-between small fw-bold"><span>OVERALL MASTERY</span><span class="p-txt">0%</span></div>
                    <div class="p-bar"><div class="p-fill pb-total"></div></div>
                </div>

                <label class="small fw-bold opacity-50 mb-2 d-block">EXTERNAL PORTALS</label>
                <a href="https://namastedev.com/" target="_blank" class="portal-link"><span>üì∫</span> Namaste Dev</a>
                <a href="https://leetcode.com/" target="_blank" class="portal-link"><span>üìä</span> LeetCode</a>
                <a href="https://bytebytego.com/" target="_blank" class="portal-link"><span>üèóÔ∏è</span> ByteByteGo</a>
                <a href="https://www.baeldung.com/" target="_blank" class="portal-link"><span>‚òï</span> Baeldung</a>
            </div>
        `;
        document.getElementById('sidebar-content').innerHTML = content;
        document.getElementById('mobile-sidebar-content').innerHTML = content;
    }

    function render() {
        if (!DATA) return;
        const grid = document.getElementById('roadmap-grid');
        let html = '';
        let trackDate = new Date(); 

        for (let i = 1; i <= 90; i++) {
            const dayData = DATA[(i-1) % DATA.length];
            const dateStr = trackDate.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
            
            html += `
                <div class="day-card">
                    <div class="day-label">
                        <span>DAY ${String(i).padStart(2, '0')}</span>
                        <span style="font-size: 0.65rem; opacity: 0.7;">${dateStr.toUpperCase()}</span>
                    </div>
                    ${dayData.tasks.map((t, idx) => `
                        <div class="task-slot">
                            <div class="task-info">
                                <input type="checkbox" id="d${i}t${idx}" onchange="saveProgress()" ${localStorage.getItem(`d${i}t${idx}`) === 'true' ? 'checked' : ''}>
                                <span class="tag" style="color:var(--${t.cat})">${t.cat.replace('-', ' ')}</span>
                                <span class="fw-bold">${t.topic}</span>
                            </div>
                            <div class="task-meta">
                                <span class="small opacity-50 fw-bold d-none d-sm-inline">${t.time}</span>
                                <a href="${t.link}" target="_blank" class="btn-study">STUDY ‚Üí</a>
                            </div>
                        </div>
                    `).join('')}
                </div>`;
            trackDate.setDate(trackDate.getDate() + 1);
        }
        grid.innerHTML = html;
        saveProgress();
    }

    function saveProgress() {
        const all = document.querySelectorAll('input[type="checkbox"]');
        let done = 0;
        all.forEach(cb => {
            if(cb.checked) { 
                done++; 
                localStorage.setItem(cb.id, 'true'); 
            } else { 
                localStorage.removeItem(cb.id); 
            }
        });
        const per = Math.round((done / (all.length || 1)) * 100);
        document.querySelectorAll('.pb-total').forEach(el => el.style.width = per + '%');
        document.querySelectorAll('.p-txt').forEach(el => el.innerText = per + '%');
    }

    window.onload = () => {
        const savedTheme = localStorage.getItem('theme') || 'dark';
        document.documentElement.setAttribute('data-theme', savedTheme);
        
        injectSidebar();
        setInterval(updateClock, 1000);
        updateClock();
        
        const dayOfYear = Math.floor((new Date() - new Date(new Date().getFullYear(), 0, 0)) / 86400000);
        if(QUOTES) {
            document.querySelectorAll('.quote-container').forEach(el => {
                el.innerText = `"${QUOTES[dayOfYear % QUOTES.length]}"`;
            });
        }
        
        render();
    };
</script>
</body>
</html>
